<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  />
  <title>Infinite Vertical Scroller</title>

  <style>
    /* Infinite Scroller (Developer Docs section) */
        @import url('https://unpkg.com/normalize.css') layer(normalize);

        @layer normalize, base, demo;

        @layer demo {
            .infinite-scroller-main-container {
                --font-level: 5;
                opacity: 0;
                width: 100%;
                max-width: 600px;
                height: 280px;
                max-height: 100%;
                display: flex;
                place-items: center;
                mask: linear-gradient(
                    #0000 0.25lh,
                    #fff calc(50% - 0.5lh),
                    #fff calc(50% + 0.5lh),
                    #0000 calc(100% - 0.25lh)
                );
                color: color-mix(in lch, canvasText, canvas 15%);
                text-align: center;
                position: relative;
                background: #0D0D0D;
                overflow: hidden;
                border-radius: 12px;
                border: 1px solid #333;
                aspect-ratio: 3 / 3.5; /* Updated aspect ratio */
            }

            .infinite-scroller-main-container ul {
                padding: 0;
                margin: 0;
                list-style-type: none;
                text-transform: uppercase;
                line-height: 1;
                font-family: Impact, Haettenschweiler, 'Arial Narrow Bold',
                sans-serif;
                height: 1lh;
                display: inline-grid;
                position: relative;
                padding-inline: 1em;
                align-items: center;
                align-content: center;
                justify-content: center;
                justify-items: center;
                text-align: center;
                width: 100%;
            }

            .infinite-scroller-main-container .indicator {
                --c: 0.3em;

                position: absolute;
                top: 50%;
                transform: translateY(-50%);
                height: 1lh;
                border: 0.05em solid oklch(0.75 1 var(--h, 320));
                transition: width 0.25s, border-color 0.25s;
                width: calc((var(--width) * 1px) + (var(--c) * 2));
                border-radius: 8px;
                opacity: 1;
            }

            .infinite-scroller-main-container li {
                display: inline-block;
                width: fit-content;
                height: 1lh;
                grid-area: 1 / 1;
            }
        }

        @layer base {
            :root {
                --font-size-min: 16;
                --font-size-max: 20;
                --font-ratio-min: 1.2;
                --font-ratio-max: 1.33;
                --font-width-min: 375;
                --font-width-max: 1500;
            }

            :where(.fluid) {
                --fluid-min: calc(
                    var(--font-size-min) *
                    pow(var(--font-ratio-min), var(--font-level, 0))
                );
                --fluid-max: calc(
                    var(--font-size-max) *
                    pow(var(--font-ratio-max), var(--font-level, 0))
                );
                --fluid-preferred: calc(
                    (var(--fluid-max) - var(--fluid-min)) /
                    (var(--font-width-max) - var(--font-width-min))
                );
                --fluid-type: clamp(
                    (var(--fluid-min) / 16) * 1rem,
                    ((var(--fluid-min) / 16) * 1rem) -
                    (((var(--fluid-preferred) * var(--font-width-min)) / 16) * 1rem) +
                    (var(--fluid-preferred) * var(--variable-unit, 100vi)),
                    (var(--fluid-max) / 16) * 1rem
                );
                font-size: var(--fluid-type);
            }

            *,
            *::before,
            *::after {
                box-sizing: border-box;
            }
        }

      body {
        display: grid;
        place-items: center;
        min-height: 100vh;
        margin: 0;
        background: #000;
        overflow: hidden;
      }
    }
  </style>
</head>

<body>
  <div class="infinite-scroller-main-container fluid">
    <div class="indicator"></div>
    <ul>
      <li>prototype.</li>
      <li>solve.</li>
      <li>build.</li>
      <li>develop.</li>
      <li>debug.</li>
      <li>learn.</li>
      <li>cook.</li>
      <li>ship.</li>
      <li>prompt.</li>
      <li>collaborate.</li>
      <li>create.</li>
      <li>inspire.</li>
      <li>follow.</li>
      <li>innovate.</li>
      <li>test.</li>
      <li>optimize.</li>
      <li>teach.</li>
      <li>visualize.</li>
      <li>transform.</li>
      <li>scale.</li>
      <li>do it.</li>
    </ul>
  </div>

  <script type="module">
    import gsap from 'https://cdn.skypack.dev/gsap@3.12.0';

    gsap.defaults({
      duration: 1,
    });

    const tl = gsap.timeline({ paused: true });
    const lines = gsap.utils.toArray('ul li');

    gsap.set('ul li', { yPercent: 300 });

    const paddedLines = [...lines, ...lines, ...lines];

    paddedLines.forEach((line, index) => {
      const lineTl = gsap.timeline()
        .set(line, { yPercent: 300 })
        .to(
          line,
          {
            yPercent: '-=600',
            repeatRefresh: true,
            immediateRender: false,
            ease: 'none',
            duration: 6,
          },
          0
        );
      tl.add(lineTl, index);
    });

    const scrubber = gsap.timeline({ paused: true }).fromTo(
      tl,
      {
        totalTime: lines.length + 1,
      },
      {
        totalTime: lines.length * 2 + 1,
        ease: 'none',
        duration: lines.length,
        repeat: -1,
      }
    );

    gsap.set(scrubber, { totalTime: lines.length + 2 });

    let index = 0;
    const indicator = document.querySelector('.infinite-scroller-main-container .indicator');

    const syncIndicator = () => {
      index += 1;
      const currentLine = lines[index % lines.length];
      const wordWidth = currentLine.getBoundingClientRect().width;

      const containerRect = document.querySelector('.infinite-scroller-main-container').getBoundingClientRect();
      const ulRect = currentLine.closest('ul').getBoundingClientRect();
      const lineRect = currentLine.getBoundingClientRect();

      const ulPaddingLeft = parseFloat(getComputedStyle(currentLine.closest('ul')).paddingLeft);

      const wordLeftInUlContent = lineRect.left - ulRect.left;

      const wordCenterXRelativeToContainer = (ulRect.left - containerRect.left) + wordLeftInUlContent + (wordWidth / 2);

      gsap.set(indicator, {
        '--width': wordWidth,
        '--h': gsap.utils.random(0, 359),
        left: wordCenterXRelativeToContainer,
        xPercent: -50
      });
    };

    const initialLine = lines[0];
    const initialWordWidth = initialLine.getBoundingClientRect().width;
    const initialContainerRect = document.querySelector('.infinite-scroller-main-container').getBoundingClientRect();
    const initialUlRect = initialLine.closest('ul').getBoundingClientRect();
    const initialLineRect = initialLine.getBoundingClientRect();
    const initialUlPaddingLeft = parseFloat(getComputedStyle(initialLine.closest('ul')).paddingLeft);
    const initialWordLeftInUlContent = initialLineRect.left - initialUlRect.left;
    const initialWordCenterXRelativeToContainer = (initialUlRect.left - initialContainerRect.left) + initialWordLeftInUlContent + (initialWordWidth / 2);

    gsap.set(indicator, {
      '--width': initialWordWidth,
      left: initialWordCenterXRelativeToContainer,
      xPercent: -50,
      '--h': gsap.utils.random(0, 359)
    });

    gsap.to(scrubber, {
      delay: 1,
      totalTime: '+=1',
      duration: 1,
      repeat: -1,
      repeatDelay: 1,
      repeatRefresh: true,
      onStart: syncIndicator,
      onRepeat: syncIndicator,
      ease: 'elastic.out(1, 0.875)',
    });

    gsap.set('.infinite-scroller-main-container', { opacity: 1 });
  </script>
</body>
</html>
